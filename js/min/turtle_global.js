var ANIMATION;var CTX;var CANVAS;var CANVAS_WIDTH;var CANVAS_HEIGHT;var DEFAULT_BG;var DEFAULT_FG;var BG;var FG;var XCOR;var YCOR;var ROTATION;var PEN_DOWN;var PI=Math.PI;var DEG2RAD=PI/180;var RAD2DEG=180/PI;var FORWARD_FAILED;var FILL="";var MODE="immediate";var FOOD_X=0;var FOOD_Y=0;var DISTANCE_TO_FOOD;var DISTANCE_LAST_TIME;var OVERLAY;var OVERLAY_CTX;var TURTLE_IMG;var TURTLE_IMG_SRC="images/turtle.png";var TURTLE_WIDTH;var TURTLE_HEIGHT;var TURTLE_LOADED=false;var TURTLE_VISIBLE=true;function RESET_CANVAS(a){a.setTransform(1,0,0,1,0,0);a.clearRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT)}function RESET(){RESET_CANVAS(CTX);CTX.fillStyle=DEFAULT_BG;CTX.strokeStyle=DEFAULT_FG;CTX.fillRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);STOP_ANIM();XCOR=CANVAS_WIDTH/2;YCOR=CANVAS_HEIGHT/2;ROTATION=0;PEN_DOWN=true;MODE="immediate";TURTLE_VISIBLE=true;CTX.translate(XCOR,YCOR);RESET_CANVAS(OVERLAY_CTX);DRAW_TURTLE()}function GET_CANVAS_POS(){var b=CANVAS;var c=0,a=0;if(b.offsetParent){do{c+=b.offsetLeft;a+=b.offsetTop}while(b=b.offsetParent)}return[c,a]}function INIT(b,c,a){if(typeof b==="string"){CANVAS=document.getElementById(b)}if(CANVAS.getContext){CTX=CANVAS.getContext("2d")}else{return}CANVAS_WIDTH=CANVAS.width;CANVAS_HEIGHT=CANVAS.height;var d=GET_CANVAS_POS();OVERLAY=CANVAS.cloneNode(false);OVERLAY.setAttribute("id","overlay");OVERLAY.style.zIndex="100";OVERLAY.style.position="absolute";OVERLAY.style.left=d[0]+"px";OVERLAY.style.top=d[1]+"px";CANVAS.parentNode.insertBefore(OVERLAY,CANVAS);OVERLAY_CTX=OVERLAY.getContext("2d");LOAD_TURTLE(TURTLE_IMG_SRC);BG=DEFAULT_BG=c||"#000000";FG=DEFAULT_FG=a||"#00FF00";CTX.save();RESET()}function LOAD_TURTLE(a){TURTLE_IMG=new Image();TURTLE_IMG.onload=function(){TURTLE_WIDTH=TURTLE_IMG.width;TURTLE_HEIGHT=TURTLE_IMG.height;TURTLE_LOADED=true;DRAW_TURTLE()};TURTLE_IMG.src=a}function FORWARD(a){if(MODE=="immediate"){CTX.beginPath();CTX.moveTo(0,0)}if(PEN_DOWN){CTX.lineTo(0,-a);CTX.translate(0,-a);if(MODE=="immediate"){CTX.stroke()}}else{CTX.moveTo(0,-a);CTX.translate(0,-a)}XCOR+=a*Math.cos(BEARING()*Math.PI/180);YCOR+=a*Math.sin(BEARING()*Math.PI/180);if(TURTLE_VISIBLE){DRAW_TURTLE()}}function BACK(a){FORWARD(-a)}function RIGHT(a){ROTATION-=a;ROTATION%=360;CTX.rotate(a*Math.PI/180);if(TURTLE_VISIBLE){DRAW_TURTLE()}}function LEFT(a){RIGHT(-a)}function REPEAT(d,c,a){for(var b=0;b<d;b++){c.apply(this,a||[])}}function BEARING(){return ROTATION+90}function PENDOWN(){PEN_DOWN=true;if(MODE=="delayed"){CTX.beginPath();CTX.moveTo(0,0)}}function PENUP(){PEN_DOWN=false}function OUT_OF_BOUNDS(){if(XCOR<0||XCOR>=CANVAS_WIDTH){return true}else{if(YCOR<0||YCOR>=CANVAS_HEIGHT){return true}else{return false}}}function MOVE_FORWARD(a){PENUP();FORWARD(a);PENDOWN()}function CHECK_FORWARD(a){PENUP();FORWARD(a);FORWARD_FAILED=OUT_OF_BOUNDS();BACK(a);if(!FORWARD_FAILED){PENDOWN();FORWARD(a)}PENDOWN()}function STUCK(){return FORWARD_FAILED}function SET_BG(a){BG=a}function SET_LINE(a){FG=a;CTX.strokeStyle=FG}function BEGIN_FILL(a){FILL=a;CTX.fillStyle=FILL;MODE="delayed";PENDOWN()}function END_FILL(){CTX.fill();CTX.stroke();MODE="immediate";FILL=""}function CENTER_X(){return CANVAS_WIDTH/2}function CENTER_Y(){return CANVAS_HEIGHT/2}function GET_WIDTH(){return CANVAS_WIDTH}function GET_HEIGHT(){return CANVAS_HEIGHT}function SET_FOOD(a,b){FOOD_X=a;FOOD_Y=b}function DIST(b,d,a,c){return Math.sqrt(Math.pow(a-b,2)+Math.pow(c-d,2))}function SMELL(){var a;DISTANCE_TO_FOOD=DIST(FOOD_X,FOOD_Y,XCOR,YCOR);if(DISTANCE_LAST_TIME===undefined){DISTANCE_LAST_TIME=DISTANCE_TO_FOOD}if(DISTANCE_TO_FOOD>DISTANCE_LAST_TIME){a="weaker"}else{a="stronger"}DISTANCE_LAST_TIME=DISTANCE_TO_FOOD;return a}function STOP_ANIM(){if(ANIMATION){clearInterval(ANIMATION)}}function ANIMATE(b,a){function c(d){d=d||1;b.call();if(a&&d<a){setTimeout(function(){c(++d)},25)}else{ANIMATION=setInterval(b,25)}}c(1)}function RESET_OVERLAY(){OVERLAY_CTX.save();OVERLAY_CTX.clearRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);OVERLAY_CTX.setTransform(1,0,0,1,0,0)}function DRAW_TURTLE(){RESET_OVERLAY();if(TURTLE_LOADED){OVERLAY_CTX.translate(XCOR,CANVAS_HEIGHT-YCOR);OVERLAY_CTX.rotate(-ROTATION*Math.PI/180);OVERLAY_CTX.drawImage(TURTLE_IMG,-TURTLE_WIDTH/2,-TURTLE_HEIGHT/2,TURTLE_WIDTH,TURTLE_HEIGHT)}OVERLAY_CTX.restore()}function HIDE_TURTLE(){RESET_OVERLAY();TURTLE_VISIBLE=false}function SHOW_TURTLE(){TURTLE_VISIBLE=true;DRAW_TURTLE()};